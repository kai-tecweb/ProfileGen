import{r as v,u as A,j as e,H,a as N}from"./app-7qfK9I34.js";import{A as B}from"./AdminV2Layout-BMPkReqh.js";import{s as M}from"./index-ikzcNs2d.js";import{B as y}from"./Button-BA9Tpm1N.js";import{M as G}from"./Modal-DNagqtOL.js";import{I as j}from"./InputLabel-pHdMUJax.js";import{I as D}from"./InputError-9PqMVSGh.js";import{M as m,r as p,h,v as g}from"./vsc-dark-plus-BpWSbEI3.js";import"./transition-BUtyYROC.js";function X({consultations:u}){const[$,b]=v.useState(!1),[o,_]=v.useState(null),[f,S]=v.useState(!1),{data:k,setData:w,post:F,processing:C,errors:P,reset:q}=A({correct_answer:"",corrected_by:""}),I=s=>{_(s),w({correct_answer:"",corrected_by:""}),S(!1),b(!0)},T=s=>{const n=s.match(/ã€è¦ç´„ã€‘\s*([\s\S]*?)(?=ã€ä»Šã™ãã‚„ã‚‹ã“ã¨ã€‘|ã€ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€‘|ã€è©³ç´°ã€‘|$)/),x=s.match(/ã€ä»Šã™ãã‚„ã‚‹ã“ã¨ã€‘\s*([\s\S]*?)(?=ã€ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€‘|ã€è©³ç´°ã€‘|$)/),i=s.match(/ã€ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€‘\s*([\s\S]*?)(?=ã€è©³ç´°ã€‘|$)/),c=s.match(/ã€è©³ç´°ã€‘\s*([\s\S]*)/);return{summary:n?n[1].trim():"",action:x?x[1].trim():"",advice:i?i[1].trim():"",detail:c?c[1].trim():s}},E=s=>{s.preventDefault(),o&&F(M("admin.consultations.correct",o.id),{preserveScroll:!0,onSuccess:()=>{b(!1),_(null),q(),N.reload()}})},L=s=>{confirm("Discordã«æŠ•ç¨¿ã—ã¾ã™ã‹ï¼Ÿ")&&N.post(M("admin.consultations.notify",s))};return e.jsxs(B,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"ç›¸è«‡å±¥æ­´ç®¡ç†"}),children:[e.jsx(H,{title:"ç›¸è«‡å±¥æ­´ç®¡ç†"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6",children:u.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"è³ªå•"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"å›ç­”"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"æ—¥æ™‚"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ä¿®æ­£æ¸ˆã¿"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"æ“ä½œ"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.data.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-md",children:e.jsx("div",{className:"whitespace-pre-wrap break-words",children:s.question.length>100?s.question.substring(0,100)+"...":s.question})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-md",children:e.jsx("div",{className:"whitespace-pre-wrap break-words",children:s.answer.length>100?s.answer.substring(0,100)+"...":s.answer})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.created_at).toLocaleString("ja-JP")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:s.is_corrected?e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800",children:"ä¿®æ­£æ¸ˆã¿"}):e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:"æœªä¿®æ­£"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[e.jsx(y,{variant:"secondary",onClick:()=>I(s),children:"ä¿®æ­£"}),e.jsx(y,{variant:"secondary",onClick:()=>L(s.id),children:"DiscordæŠ•ç¨¿"})]})]},s.id))})]})}),u.last_page>1&&e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("nav",{className:"flex space-x-2",children:u.links.map((s,n)=>e.jsx("button",{onClick:()=>{s.url&&N.visit(s.url)},disabled:!s.url||s.active,className:`px-3 py-2 rounded-md text-sm font-medium ${s.active?"bg-blue-600 text-white":s.url?"bg-white text-gray-700 hover:bg-gray-50 border border-gray-300":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:s.label}},n))})})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"ç›¸è«‡å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“"})})})})})}),e.jsx(G,{show:$,onClose:()=>b(!1),title:"å›ç­”ã‚’ä¿®æ­£",maxWidth:"2xl",children:o&&e.jsxs("form",{onSubmit:E,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(j,{htmlFor:"original_question",value:"è³ªå•"}),e.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-md border border-gray-300",children:e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:o.question})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(j,{htmlFor:"original_answer",value:"å…ƒã®å›ç­”"}),e.jsx("div",{className:"mt-1 p-3 bg-yellow-50 rounded-md border border-yellow-300 max-h-96 overflow-y-auto",children:(()=>{const{summary:s,action:n,advice:x,detail:i}=T(o.answer);return e.jsxs(e.Fragment,{children:[s&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"flex items-center mb-1",children:e.jsx("span",{className:"font-bold text-sm text-blue-600",children:"ğŸ’¡ è¦ç´„"})}),e.jsx("div",{className:"prose prose-sm max-w-none prose-headings:font-bold prose-h1:text-xl prose-h2:text-lg prose-h3:text-base prose-p:text-gray-700 prose-a:text-blue-600 prose-strong:text-gray-900",children:e.jsx(m,{remarkPlugins:[p],components:{code({node:c,inline:l,className:d,children:r,...t}){const a=/language-(\w+)/.exec(d||"");return!l&&a?e.jsx(h,{style:g,language:a[1],PreTag:"div",...t,children:String(r).replace(/\n$/,"")}):e.jsx("code",{className:"bg-gray-100 px-1 py-0.5 rounded text-sm",...t,children:r})}},children:s})})]}),n&&e.jsxs("div",{className:"mb-3 bg-yellow-100 border-l-4 border-yellow-500 p-3 rounded",children:[e.jsx("div",{className:"flex items-center mb-1",children:e.jsx("span",{className:"font-bold text-sm text-yellow-700",children:"âœ… ä»Šã™ãã‚„ã‚‹ã“ã¨"})}),e.jsx("div",{className:"prose prose-sm max-w-none prose-headings:font-bold prose-h1:text-xl prose-h2:text-lg prose-h3:text-base prose-p:text-gray-700 prose-a:text-blue-600 prose-strong:text-gray-900",children:e.jsx(m,{remarkPlugins:[p],components:{code({node:c,inline:l,className:d,children:r,...t}){const a=/language-(\w+)/.exec(d||"");return!l&&a?e.jsx(h,{style:g,language:a[1],PreTag:"div",...t,children:String(r).replace(/\n$/,"")}):e.jsx("code",{className:"bg-gray-100 px-1 py-0.5 rounded text-sm",...t,children:r})}},children:n})})]}),x&&e.jsxs("div",{className:"mb-3 bg-green-100 border-l-4 border-green-500 p-3 rounded",children:[e.jsx("div",{className:"flex items-center mb-1",children:e.jsx("span",{className:"font-bold text-sm text-green-700",children:"ğŸ’¬ ã‚¢ãƒ‰ãƒã‚¤ã‚¹"})}),e.jsx("div",{className:"prose prose-sm max-w-none prose-headings:font-bold prose-h1:text-xl prose-h2:text-lg prose-h3:text-base prose-p:text-gray-700 prose-a:text-blue-600 prose-strong:text-gray-900",children:e.jsx(m,{remarkPlugins:[p],components:{code({node:c,inline:l,className:d,children:r,...t}){const a=/language-(\w+)/.exec(d||"");return!l&&a?e.jsx(h,{style:g,language:a[1],PreTag:"div",...t,children:String(r).replace(/\n$/,"")}):e.jsx("code",{className:"bg-gray-100 px-1 py-0.5 rounded text-sm",...t,children:r})}},children:x})})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>S(!f),className:"text-blue-600 text-sm hover:underline mb-2 flex items-center",children:f?"è©³ç´°ã‚’é–‰ã˜ã‚‹ â–²":"è©³ã—ãè¦‹ã‚‹ â–¼"}),f&&e.jsxs("div",{className:"mt-2 pt-3 border-t border-gray-300",children:[e.jsx("div",{className:"flex items-center mb-1",children:e.jsx("span",{className:"font-bold text-sm text-gray-600",children:"ğŸ“– è©³ç´°"})}),e.jsx("div",{className:"prose prose-sm max-w-none prose-headings:font-bold prose-h1:text-xl prose-h2:text-lg prose-h3:text-base prose-p:text-gray-700 prose-a:text-blue-600 prose-strong:text-gray-900",children:e.jsx(m,{remarkPlugins:[p],components:{code({node:c,inline:l,className:d,children:r,...t}){const a=/language-(\w+)/.exec(d||"");return!l&&a?e.jsx(h,{style:g,language:a[1],PreTag:"div",...t,children:String(r).replace(/\n$/,"")}):e.jsx("code",{className:"bg-gray-100 px-1 py-0.5 rounded text-sm",...t,children:r})}},children:i})})]})]}),!s&&!n&&!x&&!i&&e.jsx("div",{className:"prose prose-sm max-w-none prose-headings:font-bold prose-h1:text-xl prose-h2:text-lg prose-h3:text-base prose-p:text-gray-700 prose-a:text-blue-600 prose-strong:text-gray-900",children:e.jsx(m,{remarkPlugins:[p],components:{code({node:c,inline:l,className:d,children:r,...t}){const a=/language-(\w+)/.exec(d||"");return!l&&a?e.jsx(h,{style:g,language:a[1],PreTag:"div",...t,children:String(r).replace(/\n$/,"")}):e.jsx("code",{className:"bg-gray-100 px-1 py-0.5 rounded text-sm",...t,children:r})}},children:o.answer})})]})})()})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(j,{htmlFor:"correct_answer",value:"æ­£ã—ã„å›ç­”ï¼ˆå¿…é ˆï¼‰"}),e.jsx("textarea",{id:"correct_answer",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:10,value:k.correct_answer,onChange:s=>w("correct_answer",s.target.value),required:!0,placeholder:"æ­£ã—ã„å›ç­”ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"}),e.jsx(D,{message:P.correct_answer,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(j,{htmlFor:"corrected_by",value:"ä¿®æ­£è€…åï¼ˆä»»æ„ï¼‰"}),e.jsx("input",{type:"text",id:"corrected_by",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",value:k.corrected_by,onChange:s=>w("corrected_by",s.target.value),placeholder:"ä¿®æ­£è€…åã‚’å…¥åŠ›ï¼ˆç©ºæ¬„ã®å ´åˆã¯ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼‰"}),e.jsx(D,{message:P.corrected_by,className:"mt-2"})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(y,{type:"button",variant:"secondary",onClick:()=>b(!1),children:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"}),e.jsx(y,{type:"submit",disabled:C,children:C?"ä¿®æ­£ä¸­...":"ä¿®æ­£ã™ã‚‹"})]})]})})]})}export{X as default};
