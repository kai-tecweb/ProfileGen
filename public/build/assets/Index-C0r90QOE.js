import{b as v,r as n,a as c,j as e,H as w,L as p}from"./app-7qfK9I34.js";import{A as k}from"./AuthenticatedLayout-Bq2xJ5dz.js";import{s as l}from"./index-ikzcNs2d.js";import{B as d}from"./Button-BA9Tpm1N.js";import{L as S}from"./LoadingSpinner-BZkVDNAl.js";import"./ApplicationLogo-ii1LrI5Z.js";import"./transition-BUtyYROC.js";function A({questions:o}){const{flash:t}=v().props,[u,x]=n.useState(!1),[r,a]=n.useState(!1),[i,f]=n.useState(o);n.useEffect(()=>{if(t?.success||t?.error){const s=setTimeout(()=>{c.reload({only:["questions"]})},3e3);return()=>clearTimeout(s)}},[t]),n.useEffect(()=>{f(o)},[o]);const j=s=>{confirm("この質問を削除してもよろしいですか？")&&c.delete(l("questions.destroy",s),{preserveScroll:!0})},m=()=>{confirm("質問を生成しますか？既存の質問がある場合は、先に確認してください。")&&(a(!0),c.post(l("questions.generate"),{},{preserveScroll:!1,onSuccess:()=>{a(!1)},onError:()=>{a(!1)},onFinish:()=>{a(!1)}}))},g=()=>{confirm("すべての質問を削除して再生成しますか？クライアントの回答は保持されます。")&&(a(!0),c.post(l("questions.regenerate"),{},{preserveScroll:!1,onFinish:()=>{a(!1)}}))},y=()=>{const N=`【ヒアリング質問】

${i.map((b,h)=>`Q${h+1}. ${b.question}
A${h+1}. 
`).join(`
`)}
---
上記の質問にご回答いただき、返信をお願いいたします。`;navigator.clipboard.writeText(N).then(()=>{x(!0),setTimeout(()=>x(!1),2e3)})};return e.jsxs(k,{header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"質問マスター管理"}),e.jsx("div",{className:"space-x-2",children:i.length===0?e.jsx(d,{onClick:m,disabled:r,children:r?"生成中...":"質問を生成"}):e.jsxs(e.Fragment,{children:[e.jsx(d,{onClick:g,variant:"secondary",disabled:r,children:r?"再生成中...":"質問を再生成"}),e.jsx(d,{onClick:y,variant:"secondary",children:u?"コピーしました！":"質問テキストをコピー"}),e.jsx(p,{href:l("questions.create"),children:e.jsx(d,{children:"新規追加"})})]})})]}),children:[e.jsx(w,{title:"質問マスター管理"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[r&&e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(S,{size:"sm"}),e.jsx("p",{className:"text-sm text-gray-600",children:"質問を生成中です。しばらくお待ちください..."})]}),t?.success&&e.jsx("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-md",children:e.jsx("p",{className:"text-sm text-green-800",children:t.success})}),t?.error&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:e.jsx("p",{className:"text-sm text-red-800",children:t.error})}),i.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["質問数: ",i.length,"件"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"表示順"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"質問文"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.sort_order}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:s.question}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[e.jsx(p,{href:l("questions.edit",s.id),className:"text-blue-600 hover:text-blue-900 mr-4",children:"編集"}),e.jsx("button",{onClick:()=>j(s.id),className:"text-red-600 hover:text-red-900",children:"削除"})]})]},s.id))})]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"質問が登録されていません"}),e.jsx(d,{onClick:m,disabled:r,children:r?"生成中...":"質問を生成"})]})]})})})})]})}export{A as default};
